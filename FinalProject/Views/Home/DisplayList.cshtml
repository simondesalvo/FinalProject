<html>
<head>
    <style>
        .slidecontainer {
            width: 100%; /* Width of the outside container */
        }
        /* The slider itself */
        .slider {
            -webkit-appearance: none; /* Override default CSS styles */
            width: 100%; /* Full-width */
            height: 10px; /* Specified height */
            border-radius: 5px; /* rounded */
            background: #D3D3D3; /* Grey background */
            outline: none; /* Remove outline */
            opacity: 0.7; /* Set transparency (for mouse-over effects on hover) */
            -webkit-transition: .2s; /* 0.2 seconds transition on hover */
            transition: opacity .2s;
        }
            /* Mouse-over effects */
            .slider:hover {
                opacity: 1; /* Fully shown on mouse-over */
            }
            /* The slider handle (use -webkit- (Chrome, Opera, Safari, Edge) and -moz- (Firefox) to override default look) */
            .slider::-webkit-slider-thumb {
                -webkit-appearance: none; /* Override default look */
                width: 15px; /* Set a specific slider handle width */
                height: 15px; /* Slider handle height */
                border-radius: 50%;
                background: #FF6A00; /* Green background */
                cursor: pointer; /* Cursor on hover */
            }
    </style>
</head>
<body>
    @{
        ViewData["Title"] = "Movie List";
    }
    @model List<UserMovie>
    <div>
        @{ var result = TempData["MovieExistsCheck"];}
        @if (result != null)
        {
            <p>@TempData["MovieExistsCheck"] </p>
            <br />
        }
        <table class="table table-bordered">
            <tr>
                <th> Title</th>
                <th> Watched?</th>
                <th> Watch Location</th>
                <th> Year Watched</th>
                <th> Your Rating</th>
                <th> Your Review</th>
                <th>Watched With</th>
            </tr>
            @foreach (UserMovie m in Model)
            {
                <tr>
                    <td> <a href="../Home/MovieSelection?id=@m.MovieId">@m.Title </a> </td>
                    @if (m.Watched == true)
                    {
                        <td> Watched</td>
                        <td>@m.WatchLocation </td>
                        @if (m.WatchYear != null)
                        {
                            <td>@m.WatchYear.ToString().Remove(10).TrimEnd('1') </td>
                        }
                        else
                        {
                            <td> </td>
                        }
                    }
                    else
                    {
                        <td> Not watched</td>
                        <td> n/a</td>
                        <td> n/a</td>
                    }
                    @if (m.UserRating > 0)
                    {
                        @*<td>@m.UserRating</td>*@
                        <td>
                            <form action="../Home/UpdateUserRating" method="post">
                                <div class="slidecontainer">
                                    <input name="id" hidden value=@m.Id />
                                    <p>Rating: <span id="rating"></span></p>
                                    <input type="range" min="1" max="100" value=@m.UserRating class="slider" id="userRating" name="userRating">
                                </div>
                                
                                <input type="submit" class="btn-link" onclick="return confirm('Are you sure, you want to update your rating?')" value="Change" />
                                
                            </form>
                        </td>
                    }
                    else
                    {
                        <td> </td>
                    }
                    <td>@m.UserReview </td>
                    @if (@m.WatchedTogetherId != null)
                    {
                        <td>@m.WatchedTogetherId</td>
                    }
                    else
                    {
                        <td></td>
                    }
                    <td width="100%" class="btn btn-light btn-outline-info"> <a href="../Home/UpdateMovie?id=@m.Id">Update</a> </td>
                    <td width="100%" class="btn btn-light btn-outline-danger" onclick="return confirm('Are you sure, you want to delete this movie?')"> <a href="../Home/DeleteMovie?id=@m.Id">Delete</a> </td>
                </tr>
            }
        </table>
        <a href="../Home/Search" type="button" class="btn btn-info">Title Search</a>
    </div>
</body>
</html>
<script>
    var sliders, outputs, i;
    sliders = document.querySelectorAll("#userRating");
    outputs = document.querySelectorAll("#rating");
    for (i = 0; i < sliders.length; i++) {
        outputs[i].innerHTML = sliders[i].value;
        (function (i) {
            sliders[i].addEventListener('input', function () {
                outputs[i].innerHTML = this.value;
            });
        })(i);
    }
 
</script>